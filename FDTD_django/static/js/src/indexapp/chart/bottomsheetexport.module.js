// Generated by CoffeeScript 1.9.1
(function() {
  var module;

  module = angular.module('indexapp.bottomsheetexport', []).service("generateCSVfileService", [
    function() {
      var self;
      self = this;
      self.generateCSV = function(dataarray) {
        self.csvContent = "data:text/csv;charset=utf-8,";
        if (dataarray[0].length === 3) {
          self.csvContent += "wl,n,k" + "\n";
        } else if (dataarray[0].length === 2) {
          self.csvContent += "wl,n" + "\n";
        }
        return dataarray.forEach(function(infoArray) {
          var dataString;
          dataString = infoArray.join(",");
          return self.csvContent += dataString + "\n";
        });
      };
      self.downloadCSV = function() {
        var encodedUri;
        encodedUri = encodeURI(self.csvContent);
        return window.open(encodedUri);
      };
      return 0;
    }
  ]).service("generateTXTfileService", [
    function() {
      var self;
      self = this;
      self.generateTXT = function(dataarray) {
        self.txtContent = "data:text;charset=utf-8,";
        if (dataarray[0].length === 3) {
          self.txtContent += "wl  n   k" + "\n";
        } else if (dataarray[0].length === 2) {
          self.txtContent += "wl  n" + "\n";
        }
        return dataarray.forEach(function(infoArray) {
          var dataString;
          dataString = infoArray.join("\t");
          return self.txtContent += dataString + "\n";
        });
      };
      self.downloadTXT = function() {
        var encodedUri;
        encodedUri = encodeURI(self.txtContent);
        return window.open(encodedUri);
      };
      return 0;
    }
  ]).service("generateJSONfileService", [
    function() {
      var self;
      self = this;
      self.generateJSON = function(jsonobject) {
        var jsonstring;
        jsonstring = JSON.stringify(jsonobject);
        self.JSONContent = "data:text;charset=utf-8,";
        return self.JSONContent += jsonstring;
      };
      self.downloadJSON = function() {
        var encodedUri;
        encodedUri = encodeURI(self.JSONContent);
        return window.open(encodedUri);
      };
      return 0;
    }
  ]).controller('bottomCtrl', [
    '$scope', '$timeout', '$mdBottomSheet', 'generateCSVfileService', 'indexdataService', 'generateTXTfileService', 'generateJSONfileService', function($scope, $timeout, $mdBottomSheet, generateCSVfileService, indexdataService, generateTXTfileService, generateJSONfileService) {
      return $scope.showGridBottomSheet = function($event) {
        return $mdBottomSheet.show({
          templateUrl: '/static/html/bottom-sheet-grid-template.html',
          controller: 'GridBottomSheetCtrl',
          targetEvent: $event
        }).then(function(clickedItem) {
          var dataarray, jsonobject;
          if (clickedItem.name === 'CSV') {
            dataarray = indexdataService.indexdata.dataArray;
            generateCSVfileService.generateCSV(dataarray);
            generateCSVfileService.downloadCSV();
          }
          if (clickedItem.name === 'TXT') {
            dataarray = indexdataService.indexdata.dataArray;
            generateTXTfileService.generateTXT(dataarray);
            generateTXTfileService.downloadTXT();
          }
          if (clickedItem.name === 'JSONstring') {
            jsonobject = indexdataService.indexdata.data;
            generateJSONfileService.generateJSON(jsonobject);
            return generateJSONfileService.downloadJSON();
          }
        });
      };
    }
  ]).controller('GridBottomSheetCtrl', [
    '$scope', '$mdBottomSheet', function($scope, $mdBottomSheet) {
      $scope.items = [
        {
          name: 'TXT',
          icon: 'txt'
        }, {
          name: 'CSV',
          icon: 'csv'
        }, {
          name: 'JSONstring',
          icon: 'txt'
        }
      ];
      return $scope.listItemClick = function($index) {
        var clickedItem;
        clickedItem = $scope.items[$index];
        return $mdBottomSheet.hide(clickedItem);
      };
    }
  ]);

}).call(this);

//# sourceMappingURL=bottomsheetexport.module.js.map
